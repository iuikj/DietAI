# DietAgent代码任务分析

# 基本功能

## 实现⾃定义健康规则

搜集⽤⼾基本信息，健康需求（疾病？减肥？有⽆特殊需求？）

## 根据上传图⽚提供个性化建议

拍照上传图⽚后，分析⻝物成分。(前端部分)

对于疾病⼈群，重点给出某种成分的含量，建⽴疾病**-**成分**-**含量 ，针对某种疾病关联

某种成分，在含量分析时关注这种成分。

对于减肥⼈群，重点分析某种成分含量（如热量）。

展⽰图⽚所⽰⻝物的成分含量（热量、四大营养素含量）。

根据⽤⼾历史数据，给出个性化建议。

## 记录打卡功能

进⾏主动的⼀⽇三餐、加餐记录。
⽀持拍照上传图⽚的⻝物记录

- 使用minio存储图片
- 表结构记录这次的上传图片，AI分析结果等。

对话式记录⻝物。

## 可交互、渐进式提问

根据会话历史或者上传的图⽚，进⾏⻝物cooking的建议、⻝物摄取的建议

⽐如⽤⼾上传⻝材照⽚并提问“我今天可以吃xxx吗“，在⻝物成分含量分析的基础上给

出烹饪建议。（可整为“我今天该吃什么功能”）。

对于不同健康需求可以给出不同的建议，

⽐如⽤⼾提问”今天中午吃什么“，在历史数据的基础上，针对疾病⽤⼾需要严格控制

某种成分摄⼊；针对减肥⼈群提供减肥餐建议；针对普通⽤⼾，根据平时喜好和摄⼊

提供建议。给出下⼀步可能提⽰如“你是否需要了解为什么需要控制这种成分的摄⼊”。

可以再对话这一模块中使用langmem来进行长期记忆结构记忆等等，热记忆等的Agent上下文和记忆管理（暂时还不是特别熟）

## 历史数据计算代谢

根据⽤⼾历史数据和基本信息，评估代谢⽔平，为个性化建议提供数据⽀持。

## 健康度估计

根据本次上传的⻝物和历史数据，量化出本次饮⻝的⼀个健康度。
⽐如对于奶茶，偶尔引⽤健康度可能不太低，但⻓期引⽤就会降低健康度（结合传统编码分析和langmem进行记忆的管理与裁剪，对Agent的上下文进行管理）

# 后端功能

## 用户登录，注册功能

支持微信/QQ登录（或使用uniapp的情况下是微信小程序授权登录）

## 用户初始化填写信息表格

性别、身高体重、BMI计算、运动习惯、目的等等

## 用户记录身体信息

用户更新记录自己的体重信息

## 数据库设计

表大致设计

用户表

- 用户id
- 账户
- 密码（加密）
- 关联账号（如用微信QQ和邮箱登录等等的表项，暂无头绪）

用户个人信息

- 用户id（关联用户id）
- 性别
- 身高
- 体重
- 用户运动频率和习惯
- BMI
- 是否有相关疾病
- 用户目的（减重，减脂，增重，增肌，疾病相关）
- 是否有相关疾病

用户疾病表

- 用户id
- 疾病先关项

用户每日三餐记录

- 餐食id
- 用户id（外键）
- 类别（早餐、午餐、晚餐、加餐、零食）
- 图片文件获取凭证（minio、暂未完全了解）
- 热量（大卡）
- 蛋白质
- 碳水
- 脂肪
- 纤维
- 纳
- 食物名称（AI自动识别或用户手动输入）
- 简单描述

渐进式对话

- 餐食id（外键）
- Langgraph thread id
- Langgraph Assistant id
- langmem相关（还未完全了解）

用户历史数据

- 时间
- 日总热量
- 日蛋白
- 日碳水
- 日膳食纤维
- 日纳摄入